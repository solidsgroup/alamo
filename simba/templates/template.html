{% extends "layout.html" %}
{% block content %}

<div class="container-fluid">
  <div class="row justify-content-start">
    <div class="col-md-4">
      {% include 'tables.html' %}
    </div>
    <div class="col-md-8">
      <div width="100%">
	{{ table_description | markdown }}
	<button type="button" class="btn btn-primary pull-right btn-xs" data-toggle="collapse" data-target="#form-description">Edit Description</button>
      </div>
      <br/>
      <div width="100%">
	<form class="form-group collapse out" id="form-description" action="/table/{{table_name}}" method="post">
	  <textarea class="form-control" rows="5" name='table-description'>{{ table_description }}</textarea>
	  <button class="btn btn-success pull-right" type="Update">Update</button>
	</form>
      </div>
    </div>
  </div>
</div>
<br/>

{% set status_column = -1 %}

<div class="row">
<div class="col-sm-12">
<h2>Table Entries</h2>
<div class="table-responsive">
  <table id="bigtable" class="table table-striped table-bordered" style="width:100%;">
	<thead>
	  <tr>
		{% for i in range(1,columns|length) %}
		<th> {{columns[i]}} </th> 
		{% endfor %}
	  </tr>
	</thead>
	{% for j in range(0,table|length) %}
	<tr>
	  {% for i in range (1,table[j]|length) %}
	  <td>
		{% if columns[i] == "DIR" %}
			<a href="/table/{{table_name}}/entry/{{table[j][0]}}"{{table[j][i]}}\"">{{table[j][i]}} </a> 
			{% if status[j] %}
				{% if "Complete" in status[j] %} 
					<span class="label label-success" alt="Simulation completed" style="display:inline-block;min-width:40px;"> <span class="glyphicon glyphicon-ok"/> </span></span>
				{% elif "Running" in status[j] %} 
					<span class="label label-warning" style="display:inline-block;min-width:40px;"> 
            	    {% if  status[j].split(' ')|length > 1 %}
            	       {{status[j].split(' ')[1]}}
            	    {% else %}
            	       <span class="glyphicon glyphicon-cog"/></span>
            	    {% endif %}
            	    </span>&nbsp;
            	{% elif "Interrupt" in status[j] or "Abort" in status[j] or "Segfault" in status[j] %} <span class="label label-danger" style="display:inline-block;min-width:40px;"> 
            	    {% if  status[j].split(' ')|length > 1 %}
            	       {{status[j].split(' ')[1]}}
            	    {% else %}
            	       <span class="glyphicon glyphicon-remove"/></span>
            		{% endif %}
            	    </span>&nbsp;
				{%  endif %}
			{% endif %}
			{% if numfiles|length > 0 %}{% if numfiles[j] > 0 %}
				<span class="label label-primary"> {{numfiles[j]}} </span>
			{% endif %}
		{% endif %}
		{% elif "Simulation_end_time" in columns[i] or "Simulation_start_time" in columns[i] %}
			{{table[j][i] | datetime}}
		{% else %}
			{{table[j][i] | string | truncate (50)}}
		{% endif %}
	  </td>
	  {% endfor %}
	</tr>
	{% endfor %}
  </table>
</div>
</div>
</div>



{% endblock %}
